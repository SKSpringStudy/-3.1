# 2 테스트

## 웹을 통한 DAO 테스트 방법의 문제점
1. DAO 뿐만 아니라 서비스 클래스, 컨트롤러, JSP뷰 등
모든 레이어의 기능을 다 만들고 나서야 테스트 가능
2. 에러 발생시, 어디에서 문제가 발생했는지 찾아내야되는 수고 발생

## 작은 단위의 테스트
테스트는 가능하면 작은 단위로 쪼개서 집중해서 할 수 있어야 한다.
테스트의 관심이 다르다면 테스트할 대상을 분리하고 집중해서 접근하자.
UserDaoTest의 장점을 보면

1. 웹 인터페이스, MVC 클래스, 서비스 오브젝트, 서버 배포 필요 없음
2. 에러가 나면 UserDao나 DB 연결 방법 정도에만 문제가 있는 정도이므로 원인 찾기 쉬움

이렇게 작은 단위의 코드에 테스트를 수행한 것을 ***단위 테스트(unit test)*** 라고 한다.

혹자는 DB가 사용되면 단위 테스트가 아니라고 한다.

하지만 DB를 특정 상태로 만들어줄 필요가 없다면, 즉 DB의 상태를 테스트가 관장하고 있다면 단위 테스트라고 볼 수 있다.

어쩔 때는 초기 등록부터 로그인, 각종 기능 사용 후 로그아웃까지 전체 플로우를 진행하는 긴 
테스트를 할 때도 있을 것이다.

하지만 이때도 단위 테스트를 각 기능별로 만들어두었다면, 전체를 묶어서 진행을 할때는
에러가 난다고 해도 각 단위별로 충분한 검증을 마치고 오류를 잡았으므로 에러 잡기가 훨씬 수월 할 것이다.

### 작은 단위로 나눠서 테스트가 필요한 이유

개발자가 의도한 대로 코드가 동작하는지 개발자 스스로 빨리 확인 받기 위함이다.

### 자동수행 테스트 코드
테스트를 할 때 마다 버튼 누르고, ID값 입력하고 서버 띄우고 프로그램 배치하고 이런 작업이
반복된다면 굉장히 피곤한 일이다.

UserDaoTest는 자동으로 적절한 값을 넣고, 이미 DB 연결 준비되어있는 UserDao 오브젝트를 스프링 컨테이너에서 가져와
add(),get() 등의 메소드를 호출하는 것까지 자동으로 진행된다.

이렇게 100번 돌리는데 2분도 안걸리는 것처럼 자동으로 수행되어 테스트에 부담이 없어야한다.

때로는 한줄을 고쳐도 전체 기능이 안돌아가기도 한다.

실제로 배포하고 운영중인 서비스라고 하면 간단한 수정이 전체 어플리케이션에 영향을 미치지
않을까 무섭기도 하다.

이때 만들어둔 기능에 대해 테스트들이 있다면 빠르게 전체 테스트를 돌려
수정에 대해 다른 기능에 에러가 나지 않을 것을 확인하고, 확신을 얻을 수 있다.

### 지속적인 개선과 점진적인 개발을 위한 테스트
모든 코드를 다 만들고 난 후 검증을 하려하면, 쏟아지는 에러 메시지에 기가 눌려
무엇을 할지 몰라 막막해질 수 있다.

스프링을 잘못 사용한 것인지, 설정에 오류가 있는 것인지, DAO 코드 자체를 잘못 만들었는지
찾아내는데도 적지 않은 시간을 보내야 할 것이다.

오히려 테스트를 만들면서 전체적으로 확신을 가지고 코드를 개선하는 작업에 속도가 붙고 쉬워져
테스트 만들지 않고 만들어나가는것보다 시간을 줄일 수도 있는것이다.

기능을 확장할 때도 추가한 기능의 테스트 뿐만이 아닌 기존에 만들었던 코드가 현재 추가한 
기능에 영향을 받지 않고 잘 동작하는지도 확인이 빠르게 가능하다.

